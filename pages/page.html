<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/iconeFace.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../style/logado.css">
    <link rel="stylesheet" href="../style/reset.css">
    <title id="tituloPage">Logado</title>
</head>

<body class="fundo" id="fundo">
    <div>
        <div id="minhaDiv">
            <button onclick="fechaPerfil()" class="fechaPerfil">Fechar</button>
            <div class="capa" id="capaPerfil"></div>
            <div class="paraFoto fotoPerfil" id="paraFoto">
            </div>
            <h1 class="nomePerfil" id="nomePerfil"></h1>
        </div>
    </div>
    <div class="fundoFalso" id="fundoFalso">
        <div class="barra" id="barra">
            <h1 id="textos" class="texto-barra"></h1>
            <p id="usuario-que-logou" class="usuario-que-logou"> </p>
            <img src="../images/sol.png" onclick="ModoClaro()" alt="sol" class="modo">
            <img src="../images/lua.png" onclick="ModoEscuro()" alt="lua" class="modo1">

            <div class="duvidas">
                <h1>
                    <a class="help"href="../pages/help.html">?</a> </h1>
            </div>
            <div class="menu_btn configs">
                <a href="#"></a>
                <h1 class="iconMenu">☟</h1>
                <div class="submenu">
                    <ul>
                        <li class="item">
                            <div class="titleItem" onclick="Mudarestado('minhaDiv')">Perfil</div>
                        </li>
                        <li class="item">
                            <div class="titleItem">Item</div>
                        </li>
                        <li class="item">
                            <div class="titleItem">Item</div>
                        </li>
                        <li class="item">
                            <div class="titleItem">Item</div>
                        </li>
                        <li class="item" onclick="localStorage.setItem('usuarioAtual' , JSON.stringify('')); location.href='../pages/main.html'">
                            <div class="titleItem">Sair</div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>


        <div class="pessoas">
            <div id="sugestaoAmigos">
                <h2 class="nameSujestao">Sugestão de amigos</h2>
                <div id="usuariosAdicionar">
                </div>
            </div>

            <div id="Amigos" class="Amigos">
                <h2 class="text-seusAmigos">Seus Amigos</h2>
                <div class="todosAmigos">
                    <div id="seuAmigo">

                    </div>
                </div>
            </div>
        </div>

        <!--<div class="publicar">
        <label>Título:</label>
        <input type="text" id="txtTitulo"/>
        <label>Subtítulo:</label>
        <input type="text" id="txtSubtitulo"/>
        <button id="btnEnviar" onclick="Publicar()">Publicar</button>
    </div>-->

        <!--Isso só vai aparecer se o botão for clicado-->
        <div id="geral">
            <div class="postagem">
                <button onclick="publicPic()" id="pbc-img">P/ Imagem</button>
                <button onclick="publicText()" id="pbc-text">P/ Texto</button>
                <div class="textinhos">
                    <h4 id="oquePublicar" class="oquePublicar">Oque você está pensando?</h2>
                        <h4 id="pessoaLogada" class="pessoaLogada">Teste</h4>
                </div>
                <textarea style="resize: none" name="pub-escrita" class="pub-escrita" id="pub-escrita" cols="30" rows="10"></textarea>
                <textarea style="resize: none;" id="pub-image" placeholder="Insira o Link da imagem"></textarea>
                <textarea style="resize: none;" id="pub-vide" placeholder="Insira o link do video"></textarea>
            </div>
            <button class="publicar" onclick="publicar()" id="pbc-text2">Publicar Texto</button>
            <button class="publicarImagem" onclick="publicarImagem()" id="pbc-text2">Enviar Imagem</button>
            <button class="publicarVideo" onclick="publicarVideo()" id="pbc-text2">Publicar Video</button>
        </div>

        <div id="publicacao">
            <div id="pub" class="pub">
                <div id="text-dentro-pub"></div>
            </div>
        </div>

        <!--<div id="divResultado">-->
    </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js">
    </script>
    <script src="../js/barraCode.js"></script>
    <script src="../js/Back.js.js"></script>
    <script>
        var usuarios = JSON.parse(localStorage.getItem("usuarios"))
        var Amigos = JSON.parse(localStorage.getItem("novoUsuario"))
        var usuarioLogado = JSON.parse(localStorage.getItem("usuarioAtual")) || []
        if (!usuarioLogado.nomeUsuario) location.href = "../pages/main.html"

        let todosAmigos = []
        let todosAmigosId = []



        function carregaPostsText() {
            let postagens = JSON.parse(localStorage.getItem("posts"))
            if (!postagens) return
            let quantidade = postagens.length
            let postagem = document.getElementById("pub")
            for (let i = 0; i < quantidade; i++) {

                postagem.innerHTML += `<div class="dataPub">${postagens[i].data}</div>`
                postagem.innerHTML += `<p class="nomeDeQuemPublicou">${postagens[i].from}</p>`
                postagem.innerHTML += `<p class="postagem-paragrafo">${postagens[i].content}</p>`
            }
        }
        carregaPostsText()

        function carregaPostsVide() {
            let postagens = JSON.parse(localStorage.getItem("postsVide"))
            if (!postagens) return
            let quantidade = postagens.length
            let postagem = document.getElementById("pub")
            for (let i = 0; i < quantidade; i++) {

                postagem.innerHTML += `<div class="dataPub">${postagens[i].data}</div>`
                postagem.innerHTML += `<p class="nomeDeQuemPublicou">${postagens[i].from}</p>`
                postagem.innerHTML += `<video controls class="postagem-video"><source src="${postagens[i].content}" type="video/mp4"></source></video>`
            }
        }

        carregaPostsVide()

        function carregaPostsImg() {
            let postagens = JSON.parse(localStorage.getItem("postsImg"))
            if (!postagens) return
            let quantidade = postagens.length
            let postagem = document.getElementById("pub")
            for (let i = 0; i < quantidade; i++) {

                postagem.innerHTML += `<div class="dataPub">${postagens[i].data}</div>`
                postagem.innerHTML += `<p class="nomeDeQuemPublicou">${postagens[i].from}</p>`
                postagem.innerHTML += `<img class="postagem-img" src="${postagens[i].content}">`
            }
        }

        carregaPostsImg()

        function carregaAmiguinhos() {
            let amigosAparece = JSON.parse(localStorage.getItem("amiguitos"))
            if (!amigosAparece) return
            let amigosTamanho = amigosAparece.length
            let seuAmigoLocal = document.getElementById("seuAmigo")
            for (let i = 0; i < amigosTamanho; i++) {
                amigosAparece.innerHTML += `<p class="seusAmigos">${amigosAparece[i].amigos}</p>`
                amigosAparece.innerHTML += `<button class="conversar"></button>`
            }
        }
        carregaAmiguinhos()

        function publicarVideo() {
            let publicador = usuarioLogado.nomeUsuario
            let p = document.getElementById("pub-vide").value
            if (!p) return alert("Sua publicação está vazia")
            let publicacoes = JSON.parse(localStorage.getItem("postsVide"))
            if (!publicacoes) publicacoes = []
            let data = new Date()
            data = data.toString()
            let postagem = document.getElementById("pub")
            postagem.innerHTML += `<div class="dataPub">${data}</div>`
            postagem.innerHTML += `<p class="nomeDeQuemPublicou">${publicador}</p>`
            postagem.innerHTML += `<video controls class="postagem-video"><source src="${p}" type="video/mp4"></source></video>`
            let vide = {
                from: publicador,
                content: p,
                data: data
            }
            publicacoes.push(vide)
            localStorage.setItem("postsVide", JSON.stringify(publicacoes))
        }

        function publicPic() {
            var publicacao = document.getElementById("oquePublicar")
            var desaparece = document.getElementById("pbc-img")
            var Aparece = document.getElementById("pbc-text")
            desaparece.style.opacity = "0"
            Aparece.style.opacity = "100%"
            publicacao.innerHTML = "Insira o endereço de sua imagem"

        }

        function publicText() {
            var publicacao = document.getElementById("oquePublicar")
            var desaparece = document.getElementById("pbc-text")
            var Aparece = document.getElementById("pbc-img")
            desaparece.style.opacity = "0"
            Aparece.style.opacity = "100%"
            publicacao.innerHTML = "Oque você está pensando?"
        }

        function publicar() {
            let publicador = usuarioLogado.nomeUsuario
            let p = document.getElementById("pub-escrita").value
            if (!p) return alert("Sua publicação está vazia")
            let publicacoes = JSON.parse(localStorage.getItem("posts"))
            if (!publicacoes) publicacoes = []
            let data = new Date()
            data = data.toString()
            let postagem = document.getElementById("pub")
            postagem.innerHTML += `<div class="dataPub">${data}</div>`
            postagem.innerHTML += `<p class="nomeDeQuemPublicou">${publicador}</p>`
            postagem.innerHTML += `<p class="postagem-paragrafo">${p}</p>`
            let msg = {
                from: publicador,
                content: p,
                data: data
            }
            publicacoes.push(msg)
            localStorage.setItem("posts", JSON.stringify(publicacoes))

        }

        function publicarImagem() {
            let publicador = usuarioLogado.nomeUsuario
            let p = document.getElementById("pub-image").value
            if (!p) return alert("Sua publicação está vazia")
            let publicacoes = JSON.parse(localStorage.getItem("postsImg"))
            if (!publicacoes) publicacoes = []
            let data = new Date()
            data = data.toString()
            let postagem = document.getElementById("pub")
            postagem.innerHTML += `<div class="dataPub">${data}</div>`
            postagem.innerHTML += `<p class="nomeDeQuemPublicou">${publicador}</p>`
            postagem.innerHTML += `<img class="postagem-img" src="${p}">`
            let Img = {
                from: publicador,
                content: p,
                data: data
            }
            publicacoes.push(Img)
            localStorage.setItem("postsImg", JSON.stringify(publicacoes))
        }



        function carregaSugestoesAmigos() {
            let container = document.getElementById("usuariosAdicionar")
            let usuariosAmigos = usuariosAtuais();
            container.innerHTML = ""
            for (let i = 0; i < usuariosAmigos.length; i++) {
                //cria paragrafo que aparece nome do usuario
                if (usuarioLogado.nomeUsuario !== usuarios[i].nomeUsuario) {
                   // container.innerHTML += `<div class="divUser"><p class="users">${usuariosAmigos[i].nomeUsuario}</p><div class="doButton"><button id="botaoAdicionar" class="botaoAdicionar">Adicionar</button></div></div>`
                    
                    var inexistente = todosAmigosId.indexOf(usuariosAmigos[i].id)
                    console.log(inexistente)
                    if (inexistente === -1) {
                        container.innerHTML += `<div class="divUser"><p class="users">${usuariosAmigos[i].nomeUsuario}</p><div class="doButton"><button id="botaoAdicionar" class="botaoAdicionar">Adicionar</button></div></div>`
                        let botaoAdicionar = document.getElementById("botaoAdicionar")
                        botaoAdicionar.setAttribute("onclick", `adicionarAmigo(${usuariosAmigos[i].id} ,"${usuariosAmigos[i].nomeUsuario}")`)
                            // container.appendChild(nomeUsuario);
                            // container.appendChild(botaoAdicionar)
                    }



                    // let nomeUsuario = document.createElement("p")
                    // nomeUsuario.innerHTML = usuariosAmigos[i].nomeUsuario;
                    // nomeUsuario.className = "users"
                    // let botaoAdicionar = document.createElement("button");
                    // botaoAdicionar.innerHTML = "Adicionar"
                    // console.log(usuariosAmigos[i])
                    // botaoAdicionar.setAttribute("onclick", `adicionarAmigo(${usuariosAmigos[i].id} ,"${usuariosAmigos[i].nomeUsuario}")`)
                    // botaoAdicionar.className = "botaoAdicionar"
                    // var inexistente = todosAmigosId.indexOf(usuariosAmigos[i].id)
                    // if (inexistente === -1) {
                    //     container.appendChild(nomeUsuario);
                    //     container.appendChild(botaoAdicionar)
                    // }
                }
            }
            console.log(todosAmigosId)
        }
        carregaSugestoesAmigos()

        function adicionarAmigo(ADuser, ADnome) {
            carregaSugestoesAmigos()
            alert(`Adicionando o amigo ${ADnome}`)
            todosAmigos.push(ADnome)
            todosAmigosId.push(ADuser)
            var todosSeusAmigos = document.getElementById("seuAmigo")
            todosSeusAmigos.innerHTML = ""
            let amiguinhos = JSON.parse(localStorage.getItem("amiguitos"))
            carregaSugestoesAmigos()
            for (let i = 0; i < todosAmigos.length; i++) {
                todosSeusAmigos.innerHTML += `<div class="divAmigo"><p class="seusAmigos">${todosAmigos[i]}</p><div class="doButtonAmigo"><button class="conversar">Conversar</button></div></div>`

                // var nomeUsuario = document.createElement("p")
                // nomeUsuario.classList.add("seusAmigos")
                // nomeUsuario.innerHTML = todosAmigos[i]
                // let botaoConversa = document.createElement("button")
                // botaoConversa.innerHTML = "Conversar"
                // botaoConversa.classList.add("conversar")
                // todosSeusAmigos.appendChild(nomeUsuario)
                // todosSeusAmigos.appendChild(botaoConversa)
                // console.log(todosAmigos[i])
            }

            let meagles = {
                amigos: todosAmigos
            }
            localStorage.setItem("amiguitos", JSON.stringify(meagles))

            carregaSugestoesAmigos()

        }


        console.log(todosAmigos.ADnome)
        console.log(todosAmigos)




        function carregarAmigos() {
            let todosAmigos = document.getElementById("seuAmigo")
            todosAmigos.innerHTML += `<div class="divAmigo"><p class="seusAmigos">${todosAmigos[i]}</p><div class="doButtonAmigo"><button class="conversar">Conversar</button></div></div>`
            
            //let nomeAmigo = document.createElement("p")
            //nomeAmigo.innerHTML = usuariosAtuais[i].nomeAmigo
            //todos.appendChild(nomeAmigo);
        }


        function Adicionar() {
            usuarios[0].amigos = [1]
        }

         

        $(document.body).ready(function() {
            textos = ['Compartilhe fotos', 'Publique textos', 'Conheça pessoas', 'Converse Muito', 'Divirta-se', 'Assista e compartilhe videos'];
            $('#textos').text(textos[0]);
            setInterval(function() {
                    var indexTexto = Math.floor(Math.random() * textos.length); //Pegará um número aleatório entre 0 e a quantidade de textos;
                    $('#textos').text(textos[indexTexto]); //Definirá o texto de acordo com o índice sorteado
                },
                1500); // segundo
        });

        function ModoEscuro() {
            var body = document.getElementById("fundo")
            var publicacaoColor = document.getElementById("geral")
            body.style.backgroundImage = "url('../images/img.png')"
            publicacaoColor.style.backgroundColor = "#143258"
            publicacaoColor.style.border = "solid 10px #00b8ff"
        }

        function ModoClaro() {
            var body = document.getElementById("fundo")
            var publicacaoColor = document.getElementById("geral")
            body.style.backgroundImage = "url('../images/img2.jpg')"
            body.style.backgroundSize = "1920px 1080px"
            publicacaoColor.style.backgroundColor = "rgb(215 233 255)"
            publicacaoColor.style.border = "solid 10px #00b8ff"
        }

        function pessoaQueLogou() {
            pessoaLogada = document.getElementById("pessoaLogada")
            pessoaLogada.innerHTML = usuarioLogado.nomeUsuario
        }
        pessoaQueLogou();
        carregaSugestoesAmigos();
    </script>
</body>

</html>